# üèóÔ∏è ARCHITEKTURA I PRZEP≈ÅYW DANYCH - SZCZEG√ì≈ÅOWO

> **Cel:** Wyt≈Çumaczenie juniorowi jak dane przep≈ÇywajƒÖ przez system od frontendu do bazy i z powrotem
> **Dla kogo:** Obrona pracy - wyja≈õnienie architektury ka≈ºdemu

---

## üìã SPIS TRE≈öCI

1. [Przep≈Çyw Logowania - Krok Po Kroku](#1-przep≈Çyw-logowania---krok-po-kroku)
2. [Przep≈Çyw CRUD Klient√≥w](#2-przep≈Çyw-crud-klient√≥w)
3. [Przep≈Çyw Generowania PDF](#3-przep≈Çyw-generowania-pdf)
4. [System Powiadomie≈Ñ - Real-time](#4-system-powiadomie≈Ñ---real-time)
5. [Architektura Bezpiecze≈Ñstwa](#5-architektura-bezpiecze≈Ñstwa)
6. [Pytania Obronne z Odpowiedziami](#6-pytania-obronne-z-odpowiedziami)

---

## 1. PRZEP≈ÅYW LOGOWANIA - KROK PO KROKU

### 1.1 Kompletny Przep≈Çyw

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   USER      ‚îÇ
‚îÇ wpisuje:    ‚îÇ
‚îÇ - username  ‚îÇ
‚îÇ - password  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND (React LoginPage.tsx)          ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ const handleLogin = async () => {       ‚îÇ
‚îÇ   const res = await api.post(           ‚îÇ
‚îÇ     '/Auth/login',                      ‚îÇ
‚îÇ     { username, password }              ‚îÇ
‚îÇ   );                                     ‚îÇ
‚îÇ }                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ HTTP POST
       ‚îÇ http://localhost:8100/api/Auth/login
       ‚îÇ Body: {"username":"admin","password":"admin123"}
       ‚îÇ
       ‚ñº (Vite Proxy)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ VITE DEV SERVER :8100                   ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ proxy: {                                 ‚îÇ
‚îÇ   '/api': 'http://localhost:5000'      ‚îÇ
‚îÇ }                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Przekierowanie
       ‚îÇ http://localhost:5000/api/Auth/login
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND (Flask app.py :5000)            ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ @auth_bp.route('/login', methods=['POST'])‚îÇ
‚îÇ def login():                             ‚îÇ
‚îÇ   # 1. Pobierz dane                     ‚îÇ
‚îÇ   data = request.get_json()             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ WALIDACJA                                ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ if not username or not password:        ‚îÇ
‚îÇ   return {'error': '...'}, 400          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BAZA DANYCH (MariaDB/SQLite)            ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ SELECT * FROM users                      ‚îÇ
‚îÇ WHERE username = 'admin';                ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ Result:                                  ‚îÇ
‚îÇ {                                        ‚îÇ
‚îÇ   id: 1,                                 ‚îÇ
‚îÇ   username: 'admin',                     ‚îÇ
‚îÇ   password_hash: '$2b$12$...',          ‚îÇ
‚îÇ   role_id: 1                             ‚îÇ
‚îÇ }                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ WERYFIKACJA HAS≈ÅA (bcrypt)              ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ bcrypt.checkpw(                          ‚îÇ
‚îÇ   'admin123',                            ‚îÇ
‚îÇ   '$2b$12$...'                           ‚îÇ
‚îÇ )                                        ‚îÇ
‚îÇ ‚Üí True ‚úì                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ GENEROWANIE JWT                          ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ payload = {                              ‚îÇ
‚îÇ   'user_id': 1,                          ‚îÇ
‚îÇ   'username': 'admin',                   ‚îÇ
‚îÇ   'role': 'Admin',                       ‚îÇ
‚îÇ   'exp': now + 24h                       ‚îÇ
‚îÇ }                                        ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ token = jwt.encode(                      ‚îÇ
‚îÇ   payload,                               ‚îÇ
‚îÇ   SECRET_KEY,                            ‚îÇ
‚îÇ   algorithm='HS256'                      ‚îÇ
‚îÇ )                                        ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ token = "eyJhbGc...XYZ"                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ ZAPIS LoginHistory                       ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ INSERT INTO LoginHistory (               ‚îÇ
‚îÇ   UserId, IpAddress, UserAgent,         ‚îÇ
‚îÇ   Success, LoginTime                     ‚îÇ
‚îÇ ) VALUES (                               ‚îÇ
‚îÇ   1, '127.0.0.1', 'Mozilla/...',        ‚îÇ
‚îÇ   TRUE, '2025-10-06 14:30:00'           ‚îÇ
‚îÇ )                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ RESPONSE (JSON)                          ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ HTTP 200 OK                              ‚îÇ
‚îÇ {                                        ‚îÇ
‚îÇ   "token": "eyJhbGc...XYZ",              ‚îÇ
‚îÇ   "user": {                              ‚îÇ
‚îÇ     "id": 1,                             ‚îÇ
‚îÇ     "username": "admin",                 ‚îÇ
‚îÇ     "email": "admin@example.com",        ‚îÇ
‚îÇ     "role": "Admin"                      ‚îÇ
‚îÇ   }                                      ‚îÇ
‚îÇ }                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND (LoginPage.tsx)                ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ localStorage.setItem('token', token);   ‚îÇ
‚îÇ window.location.href = '/dashboard';    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ AUTHCONTEXT (AuthContext.tsx)           ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ useEffect(() => {                        ‚îÇ
‚îÇ   const token = localStorage.getItem('token');‚îÇ
‚îÇ   if (token) {                           ‚îÇ
‚îÇ     const decoded = jwtDecode(token);   ‚îÇ
‚îÇ     setUser({                            ‚îÇ
‚îÇ       username: decoded.username,       ‚îÇ
‚îÇ       role: decoded.role                ‚îÇ
‚îÇ     });                                  ‚îÇ
‚îÇ   }                                      ‚îÇ
‚îÇ }, []);                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DASHBOARD - Zalogowany!                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 1.2 Wyja≈õnienie Ka≈ºdego Kroku

#### Krok 1: User wpisuje dane
- Frontend renderuje formularz logowania
- useState przechowuje username i password
- Controlled inputs (value + onChange)

#### Krok 2: Frontend wysy≈Ça POST request
```typescript
const handleLogin = async () => {
    try {
        const response = await api.post('/Auth/login', {
            username: username,  // "admin"
            password: password   // "admin123"
        });
        // response.data = { token: "...", user: {...} }
    } catch (error) {
        // Obs≈Çuga b≈Çƒôd√≥w
    }
};
```

#### Krok 3: Vite Proxy przekierowuje
```typescript
// vite.config.ts
server: {
    proxy: {
        '/api': {
            target: 'http://localhost:5000',
            changeOrigin: true
        }
    }
}
// /api/Auth/login ‚Üí http://localhost:5000/api/Auth/login
```

#### Krok 4: Flask otrzymuje request
```python
@auth_bp.route('/login', methods=['POST'])
def login():
    data = request.get_json()
    # data = {"username": "admin", "password": "admin123"}

    username = data['username']
    password = data['password']
```

#### Krok 5: Walidacja danych
```python
if not username or not password:
    return jsonify({'error': 'Username i password sƒÖ wymagane'}), 400
```

#### Krok 6: Zapytanie do bazy (SQLAlchemy)
```python
user = User.query.filter_by(username=username).first()

# SQLAlchemy generuje SQL:
# SELECT id, username, password_hash, role_id
# FROM users
# WHERE username = ?
# LIMIT 1

# Zwraca:
# User(id=1, username='admin', password_hash='$2b$12$...', role_id=1)
```

#### Krok 7: Weryfikacja has≈Ça (bcrypt)
```python
import bcrypt

# Por√≥wnaj wprowadzone has≈Ço z hashem w bazie
is_valid = bcrypt.checkpw(
    password.encode('utf-8'),           # "admin123"
    user.password_hash.encode('utf-8')  # "$2b$12$..."
)

# bcrypt:
# 1. WyciƒÖga s√≥l z hasha ($2b$12$...)
# 2. Hashuje wprowadzone has≈Ço z tƒÖ samƒÖ solƒÖ
# 3. Por√≥wnuje hashe
# 4. Zwraca True/False
```

#### Krok 8: Generowanie JWT
```python
import jwt
from datetime import datetime, timedelta

payload = {
    'user_id': user.id,         # 1
    'username': user.username,   # "admin"
    'role': user.role.name,      # "Admin"
    'exp': datetime.utcnow() + timedelta(hours=24)  # Wygasa po 24h
}

token = jwt.encode(
    payload,
    Config.JWT_SECRET_KEY,  # "secret-key-change-in-production"
    algorithm='HS256'
)

# token = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjoxLCJ1c2VybmFtZSI6ImFkbWluIiwicm9sZSI6IkFkbWluIiwiZXhwIjoxNjIzOTc4ODAwfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c"
```

#### Krok 9: Zapis LoginHistory
```python
login_history = LoginHistory(
    UserId=user.id,                      # 1
    IpAddress=request.remote_addr,       # "127.0.0.1"
    UserAgent=request.headers.get('User-Agent'),  # "Mozilla/..."
    Success=True,
    LoginTime=datetime.utcnow()
)
db.session.add(login_history)
db.session.commit()

# SQL:
# INSERT INTO LoginHistory (UserId, IpAddress, UserAgent, Success, LoginTime)
# VALUES (1, '127.0.0.1', 'Mozilla/...', TRUE, '2025-10-06 14:30:00')
```

#### Krok 10: Odpowied≈∫ JSON
```python
return jsonify({
    'token': token,
    'user': {
        'id': user.id,
        'username': user.username,
        'email': user.email,
        'role': user.role.name
    }
}), 200
```

#### Krok 11: Frontend zapisuje token
```typescript
const { token, user } = response.data;

// Zapisz token w localStorage
localStorage.setItem('token', token);

// Redirect do dashboard (full page reload)
window.location.href = '/dashboard';
```

#### Krok 12: AuthContext ≈Çaduje u≈ºytkownika
```typescript
useEffect(() => {
    const token = localStorage.getItem('token');
    if (!token) return;

    // Dekoduj token
    const decoded = jwtDecode<JwtPayload>(token);

    // Sprawd≈∫ czy nie wygas≈Ç
    if (decoded.exp * 1000 < Date.now()) {
        logout();
        return;
    }

    // Ustaw u≈ºytkownika w stanie
    setUser({
        username: decoded.username,
        role: decoded.role
    });

    setLoading(false);
}, []);
```

#### Krok 13: Axios Interceptor dodaje token do request√≥w
```typescript
api.interceptors.request.use(config => {
    const token = localStorage.getItem('token');
    if (token) {
        config.headers.Authorization = `Bearer ${token}`;
    }
    return config;
});

// Teraz ka≈ºde zapytanie ma nag≈Ç√≥wek:
// Authorization: Bearer eyJhbGc...XYZ
```

---

## 2. PRZEP≈ÅYW CRUD KLIENT√ìW

### 2.1 GET /api/Customers - Pobieranie Listy

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND    ‚îÇ
‚îÇ ClientsPage ‚îÇ
‚îÇ             ‚îÇ
‚îÇ useEffect(() => {
‚îÇ   fetchCustomers();
‚îÇ }, []);
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Axios Request                     ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ GET /api/Customers                ‚îÇ
‚îÇ Headers:                          ‚îÇ
‚îÇ   Authorization: Bearer eyJ...    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND                           ‚îÇ
‚îÇ @customers_bp.route('/')          ‚îÇ
‚îÇ @require_auth                     ‚îÇ
‚îÇ def get_customers():              ‚îÇ
‚îÇ   # 1. Middleware sprawdza token  ‚îÇ
‚îÇ   # 2. Pobiera wszystkich klient√≥w‚îÇ
‚îÇ   customers = Customer.query.all()‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DATABASE                          ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ SELECT * FROM Customers           ‚îÇ
‚îÇ ORDER BY CreatedAt DESC           ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ Results: [                        ‚îÇ
‚îÇ   {Id:1, Name:"Jan", Email:"..."},‚îÇ
‚îÇ   {Id:2, Name:"Anna", ...},       ‚îÇ
‚îÇ   ...                             ‚îÇ
‚îÇ ]                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND - Serializacja            ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ return jsonify([                  ‚îÇ
‚îÇ   customer.to_dict()              ‚îÇ
‚îÇ   for customer in customers       ‚îÇ
‚îÇ ])                                ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ Response: 200 OK                  ‚îÇ
‚îÇ [                                 ‚îÇ
‚îÇ   {"id":1,"name":"Jan",...},      ‚îÇ
‚îÇ   {"id":2,"name":"Anna",...}      ‚îÇ
‚îÇ ]                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND - Update State           ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ setCustomers(response.data);      ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ // React re-renderuje             ‚îÇ
‚îÇ <FlatList data={customers} />     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.2 POST /api/Customers - Dodawanie Klienta

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ USER        ‚îÇ
‚îÇ Wype≈Çnia    ‚îÇ
‚îÇ formularz:  ‚îÇ
‚îÇ - name      ‚îÇ
‚îÇ - email     ‚îÇ
‚îÇ - phone     ‚îÇ
‚îÇ - company   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND AddClientPage            ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ const handleSubmit = async () => {‚îÇ
‚îÇ   await api.post('/Customers/', {‚îÇ
‚îÇ     name, email, phone, company   ‚îÇ
‚îÇ   });                             ‚îÇ
‚îÇ };                                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ POST /api/Customers/
       ‚îÇ Body: {"name":"Jan Kowalski","email":"jan@..."}
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND                           ‚îÇ
‚îÇ @customers_bp.route('/')          ‚îÇ
‚îÇ @require_auth                     ‚îÇ
‚îÇ def create_customer():            ‚îÇ
‚îÇ   data = request.get_json()       ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ   # Tworzenie obiektu             ‚îÇ
‚îÇ   customer = Customer(            ‚îÇ
‚îÇ     Name=data['name'],            ‚îÇ
‚îÇ     Email=data.get('email'),      ‚îÇ
‚îÇ     Phone=data.get('phone'),      ‚îÇ
‚îÇ     Company=data.get('company')   ‚îÇ
‚îÇ   )                               ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ   db.session.add(customer)        ‚îÇ
‚îÇ   db.session.commit()             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DATABASE                          ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ INSERT INTO Customers (           ‚îÇ
‚îÇ   Name, Email, Phone, Company,    ‚îÇ
‚îÇ   CreatedAt                       ‚îÇ
‚îÇ ) VALUES (                        ‚îÇ
‚îÇ   'Jan Kowalski',                 ‚îÇ
‚îÇ   'jan@example.com',              ‚îÇ
‚îÇ   '123456789',                    ‚îÇ
‚îÇ   'ABC Sp. z o.o.',               ‚îÇ
‚îÇ   '2025-10-06 14:30:00'           ‚îÇ
‚îÇ )                                 ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ RETURNING Id;  ‚Üí 33               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND - Response                ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ return jsonify(                   ‚îÇ
‚îÇ   customer.to_dict()              ‚îÇ
‚îÇ ), 201                            ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ Response: 201 Created             ‚îÇ
‚îÇ {"id":33,"name":"Jan Kowalski",...}‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND                          ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ navigate('/klienci');             ‚îÇ
‚îÇ openToast('Klient dodany!');      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.3 DELETE /api/Customers/:id - Usuwanie Klienta

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ USER        ‚îÇ
‚îÇ Klika       ‚îÇ
‚îÇ "Usu≈Ñ"      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND - Confirm Dialog         ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ openModal({                       ‚îÇ
‚îÇ   type: 'confirm',                ‚îÇ
‚îÇ   title: 'Potwierd≈∫ usuniƒôcie',  ‚îÇ
‚îÇ   message: 'Czy na pewno?',       ‚îÇ
‚îÇ   onConfirm: async () => {        ‚îÇ
‚îÇ     await api.delete(`/Customers/${id}`);‚îÇ
‚îÇ     fetchCustomers();             ‚îÇ
‚îÇ   }                               ‚îÇ
‚îÇ });                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ User klika "Potwierd≈∫"
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Axios Request                     ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ DELETE /api/Customers/33          ‚îÇ
‚îÇ Headers:                          ‚îÇ
‚îÇ   Authorization: Bearer eyJ...    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND                           ‚îÇ
‚îÇ @customers_bp.route('/<int:id>') ‚îÇ
‚îÇ @require_auth                     ‚îÇ
‚îÇ def delete_customer(id):          ‚îÇ
‚îÇ   customer = Customer.query.get(id)‚îÇ
‚îÇ   if not customer:                ‚îÇ
‚îÇ     return {'error':'...'}, 404   ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ   db.session.delete(customer)     ‚îÇ
‚îÇ   db.session.commit()             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DATABASE                          ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ DELETE FROM Customers             ‚îÇ
‚îÇ WHERE Id = 33                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND - Response                ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ return jsonify({                  ‚îÇ
‚îÇ   'message': 'Klient usuniƒôty'    ‚îÇ
‚îÇ }), 200                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND                          ‚îÇ
‚îÇ                                   ‚îÇ
‚îÇ fetchCustomers();  // Od≈õwie≈º listƒô‚îÇ
‚îÇ openToast('Klient usuniƒôty');     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## 3. PRZEP≈ÅYW GENEROWANIA PDF

### 3.1 Pobieranie PDF Faktury (Mobile)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ USER        ‚îÇ
‚îÇ Klika       ‚îÇ
‚îÇ "Pobierz    ‚îÇ
‚îÇ  PDF"       ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ MOBILE InvoiceDetailScreen                ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ const downloadPDF = async () => {         ‚îÇ
‚îÇ   setIsDownloading(true);                 ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   // 1. Pobierz PDF z API                ‚îÇ
‚îÇ   const response = await api.get(         ‚îÇ
‚îÇ     `/Invoices/${id}/pdf?token=${token}`,‚îÇ
‚îÇ     { responseType: 'blob' }              ‚îÇ
‚îÇ   );                                      ‚îÇ
‚îÇ };                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ GET /api/Invoices/5/pdf?token=eyJ...
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND - Manual Auth                     ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ @invoices_bp.route('/<int:id>/pdf')      ‚îÇ
‚îÇ def generate_invoice_pdf(id):            ‚îÇ
‚îÇ   # Manualna weryfikacja JWT z query     ‚îÇ
‚îÇ   token = request.args.get('token')      ‚îÇ
‚îÇ   payload = jwt.decode(token, SECRET_KEY)‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   # Pobierz fakturƒô                       ‚îÇ
‚îÇ   invoice = Invoice.query.options(       ‚îÇ
‚îÇ     joinedload(Invoice.customer),        ‚îÇ
‚îÇ     joinedload(Invoice.payments)         ‚îÇ
‚îÇ   ).get(id)                               ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DATABASE                                  ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ SELECT                                    ‚îÇ
‚îÇ   Invoices.*,                             ‚îÇ
‚îÇ   Customers.Name as customer_name,        ‚îÇ
‚îÇ   Payments.*                              ‚îÇ
‚îÇ FROM Invoices                             ‚îÇ
‚îÇ LEFT JOIN Customers                       ‚îÇ
‚îÇ   ON Invoices.CustomerId = Customers.Id  ‚îÇ
‚îÇ LEFT JOIN Payments                        ‚îÇ
‚îÇ   ON Payments.InvoiceId = Invoices.Id    ‚îÇ
‚îÇ WHERE Invoices.Id = 5                     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND - ReportLab                       ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ def create_invoice_pdf(invoice):         ‚îÇ
‚îÇ   buffer = BytesIO()                      ‚îÇ
‚îÇ   doc = SimpleDocTemplate(buffer, A4)     ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   elements = []                           ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   # Tytu≈Ç                                 ‚îÇ
‚îÇ   title = Paragraph("FAKTURA", styles)    ‚îÇ
‚îÇ   elements.append(title)                  ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   # Dane faktury (tabela)                ‚îÇ
‚îÇ   data = [                                ‚îÇ
‚îÇ     ['Numer:', invoice.Number],           ‚îÇ
‚îÇ     ['Data:', invoice.IssuedAt],          ‚îÇ
‚îÇ     ['Kwota:', f'{invoice.Total} PLN']    ‚îÇ
‚îÇ   ]                                       ‚îÇ
‚îÇ   table = Table(data)                     ‚îÇ
‚îÇ   elements.append(table)                  ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   # Build PDF                             ‚îÇ
‚îÇ   doc.build(elements)                     ‚îÇ
‚îÇ   buffer.seek(0)                          ‚îÇ
‚îÇ   return buffer                           ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ pdf_buffer = create_invoice_pdf(invoice)  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND - HTTP Response                   ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ response = make_response(pdf_buffer.read())‚îÇ
‚îÇ response.headers['Content-Type'] =       ‚îÇ
‚îÇ   'application/pdf'                       ‚îÇ
‚îÇ response.headers['Content-Disposition'] = ‚îÇ
‚îÇ   'inline; filename=faktura_5.pdf'        ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ return response                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Binary PDF data
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ MOBILE - FileReader                       ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ // 2. Konwertuj Blob ‚Üí Base64            ‚îÇ
‚îÇ const reader = new FileReader();          ‚îÇ
‚îÇ reader.readAsDataURL(response.data);      ‚îÇ
‚îÇ reader.onloadend = async () => {          ‚îÇ
‚îÇ   const base64 =                          ‚îÇ
‚îÇ     reader.result.split(',')[1];          ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   // 3. Zapisz do FileSystem              ‚îÇ
‚îÇ   const fileUri =                         ‚îÇ
‚îÇ     FileSystem.documentDirectory +        ‚îÇ
‚îÇ     `faktura_${id}.pdf`;                  ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   await FileSystem.writeAsStringAsync(    ‚îÇ
‚îÇ     fileUri,                              ‚îÇ
‚îÇ     base64,                               ‚îÇ
‚îÇ     {encoding: Base64}                    ‚îÇ
‚îÇ   );                                      ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   // 4. Udostƒôpnij plik                   ‚îÇ
‚îÇ   await Sharing.shareAsync(fileUri);      ‚îÇ
‚îÇ };                                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ iOS/Android Share Sheet                   ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                    ‚îÇ
‚îÇ ‚îÇ Udostƒôpnij przez:  ‚îÇ                    ‚îÇ
‚îÇ ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§                    ‚îÇ
‚îÇ ‚îÇ üìß Mail            ‚îÇ                    ‚îÇ
‚îÇ ‚îÇ üí¨ Messages        ‚îÇ                    ‚îÇ
‚îÇ ‚îÇ üì± WhatsApp        ‚îÇ                    ‚îÇ
‚îÇ ‚îÇ ‚òÅÔ∏è  iCloud Drive   ‚îÇ                    ‚îÇ
‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 3.2 Wyja≈õnienie Techniczne

#### Dlaczego Blob ‚Üí Base64 ‚Üí FileSystem?
```
1. Backend zwraca binary PDF (application/pdf)
2. Axios otrzymuje jako Blob (binary large object)
3. React Native nie ma bezpo≈õredniego dostƒôpu do Blob
4. FileReader.readAsDataURL() konwertuje Blob ‚Üí Data URL
5. Data URL format: "data:application/pdf;base64,JVBERi0xLjQKJeLjz9MK..."
6. Split(',')[1] wyciƒÖga czƒô≈õƒá Base64
7. FileSystem.writeAsStringAsync() zapisuje Base64 jako plik
8. Sharing.shareAsync() pokazuje system share sheet
```

#### Dlaczego token w query parameter?
```
// ‚ùå Problem: <embed src="/api/Invoices/5/pdf">
// Nie mogƒô dodaƒá nag≈Ç√≥wka Authorization do <embed>

// ‚úÖ RozwiƒÖzanie: /api/Invoices/5/pdf?token=eyJ...
// Token w URL (manualna weryfikacja w kontrolerze)
```

‚ö†Ô∏è **Uwaga bezpiecze≈Ñstwa:** Token w URL mo≈ºe byƒá logowany w access logs. W produkcji lepiej u≈ºyƒá:
- Short-lived tokens (exp: 1min)
- Lub signed URLs (AWS S3 style)

---

## 4. SYSTEM POWIADOMIE≈É - REAL-TIME

### 4.1 Polling Pattern (U≈ºyty w Projekcie)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND Layout.tsx                      ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ useEffect(() => {                        ‚îÇ
‚îÇ   const fetchNotifications = async () => {‚îÇ
‚îÇ     const response =                     ‚îÇ
‚îÇ       await api.get('/Notifications/user');‚îÇ
‚îÇ     setNotifications(response.data);     ‚îÇ
‚îÇ   };                                     ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ   fetchNotifications();  // Natychmiast  ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ   const interval = setInterval(          ‚îÇ
‚îÇ     fetchNotifications,                  ‚îÇ
‚îÇ     30000  // Co 30 sekund               ‚îÇ
‚îÇ   );                                     ‚îÇ
‚îÇ                                          ‚îÇ
‚îÇ   return () => clearInterval(interval);  ‚îÇ
‚îÇ }, []);                                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Co 30s
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ BACKEND                                   ‚îÇ
‚îÇ @notifications_bp.route('/user')         ‚îÇ
‚îÇ @require_auth                             ‚îÇ
‚îÇ def get_user_notifications():            ‚îÇ
‚îÇ   user_id = get_current_user_id()        ‚îÇ
‚îÇ   notifications = Notification.query     ‚îÇ
‚îÇ     .filter_by(UserId=user_id)           ‚îÇ
‚îÇ     .order_by(                            ‚îÇ
‚îÇ       Notification.CreatedAt.desc()      ‚îÇ
‚îÇ     )                                     ‚îÇ
‚îÇ     .limit(50)                            ‚îÇ
‚îÇ     .all()                                ‚îÇ
‚îÇ   return jsonify([n.to_dict()            ‚îÇ
‚îÇ     for n in notifications])             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ DATABASE                                  ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ SELECT * FROM Notifications               ‚îÇ
‚îÇ WHERE UserId = 1                          ‚îÇ
‚îÇ ORDER BY CreatedAt DESC                   ‚îÇ
‚îÇ LIMIT 50                                  ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ Results: [                                ‚îÇ
‚îÇ   {Id:10, Message:"...", IsRead:false},   ‚îÇ
‚îÇ   {Id:9, Message:"...", IsRead:true},     ‚îÇ
‚îÇ   ...                                     ‚îÇ
‚îÇ ]                                         ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ FRONTEND - Wykrywanie Nowych             ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ const prevNotifications = useRef([]);     ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ useEffect(() => {                         ‚îÇ
‚îÇ   const newNotifications =                ‚îÇ
‚îÇ     notifications.filter(n =>             ‚îÇ
‚îÇ       !prevNotifications.current          ‚îÇ
‚îÇ         .find(prev => prev.id === n.id)   ‚îÇ
‚îÇ     );                                    ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   if (newNotifications.length > 0) {      ‚îÇ
‚îÇ     setNewNotificationToast(              ‚îÇ
‚îÇ       newNotifications[0]                 ‚îÇ
‚îÇ     );                                    ‚îÇ
‚îÇ     // Toast znika po 5s                  ‚îÇ
‚îÇ   }                                       ‚îÇ
‚îÇ                                           ‚îÇ
‚îÇ   prevNotifications.current =             ‚îÇ
‚îÇ     notifications;                        ‚îÇ
‚îÇ }, [notifications]);                      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 4.2 Dlaczego Polling zamiast WebSockets?

| Feature | Polling (u≈ºyte) | WebSockets |
|---------|----------------|------------|
| Implementacja | ‚úÖ Prosta (setInterval) | ‚ùå Z≈Ço≈ºona (socket.io) |
| ObciƒÖ≈ºenie | ‚ö†Ô∏è Request co 30s | ‚úÖ Push tylko przy zmianie |
| Skalowalno≈õƒá | ‚úÖ Stateless (load balancer friendly) | ‚ö†Ô∏è Sticky sessions |
| Realtime | ‚ö†Ô∏è Op√≥≈∫nienie do 30s | ‚úÖ Instant |
| Idealne dla | Powiadomienia (nie krytyczne) | Chat, Live updates |

**Decyzja:** Dla CRM powiadomienia nie muszƒÖ byƒá instant. Op√≥≈∫nienie 30s jest akceptowalne, a polling jest prostszy.

---

## 5. ARCHITEKTURA BEZPIECZE≈ÉSTWA

### 5.1 Warstwy Bezpiecze≈Ñstwa

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ WARSTWA 1: TRANSPORT                    ‚îÇ
‚îÇ ‚úÖ HTTPS (produkcja)                    ‚îÇ
‚îÇ ‚úÖ TLS 1.3                              ‚îÇ
‚îÇ ‚ùå HTTP (development tylko!)            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ WARSTWA 2: CORS                         ‚îÇ
‚îÇ ‚úÖ Whitelist origins                    ‚îÇ
‚îÇ ‚úÖ credentials: true                    ‚îÇ
‚îÇ ‚úÖ Preflight requests                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ WARSTWA 3: AUTORYZACJA JWT              ‚îÇ
‚îÇ ‚úÖ @require_auth middleware             ‚îÇ
‚îÇ ‚úÖ Token expiration (24h)               ‚îÇ
‚îÇ ‚úÖ Signature verification (HS256)       ‚îÇ
‚îÇ ‚ùå Refresh tokens (TODO)                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ WARSTWA 4: ROLE-BASED ACCESS            ‚îÇ
‚îÇ ‚úÖ @require_admin decorator             ‚îÇ
‚îÇ ‚úÖ User roles (Admin, User)             ‚îÇ
‚îÇ ‚ö†Ô∏è Brak row-level permissions           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ WARSTWA 5: INPUT VALIDATION             ‚îÇ
‚îÇ ‚ö†Ô∏è Podstawowa walidacja (if not data)   ‚îÇ
‚îÇ ‚ùå Brak schema validation               ‚îÇ
‚îÇ ‚úÖ SQLAlchemy ORM (SQL injection proof) ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ WARSTWA 6: PASSWORD SECURITY            ‚îÇ
‚îÇ ‚úÖ bcrypt hashowanie                    ‚îÇ
‚îÇ ‚úÖ Automatyczna s√≥l                     ‚îÇ
‚îÇ ‚úÖ Cost factor 12                       ‚îÇ
‚îÇ ‚ö†Ô∏è MD5 fallback (legacy)                ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ WARSTWA 7: AUDIT LOGGING                ‚îÇ
‚îÇ ‚úÖ LoginHistory                         ‚îÇ
‚îÇ ‚úÖ SystemLogs                           ‚îÇ
‚îÇ ‚úÖ IP + UserAgent tracking              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 5.2 Podatno≈õci i Mitigacje

#### XSS (Cross-Site Scripting)
```
Podatno≈õƒá:
<div>{customer.name}</div>
// customer.name = "<script>alert('XSS')</script>"

Mitigacja:
‚úÖ React automatycznie escapuje (dangerouslySetInnerHTML not used)
‚úÖ Backend: nie zwraca HTML, tylko JSON
‚ö†Ô∏è Backend: brak sanityzacji inputu
```

#### SQL Injection
```
Podatno≈õƒá:
query = f"SELECT * FROM users WHERE username = '{username}'"
// username = "admin' OR '1'='1"

Mitigacja:
‚úÖ SQLAlchemy ORM (parametryzowane zapytania)
User.query.filter_by(username=username)
// ‚Üí SELECT * FROM users WHERE username = ?
```

#### CSRF (Cross-Site Request Forgery)
```
Podatno≈õƒá:
<img src="http://crm.com/api/Customers/1/delete">

Mitigacja:
‚úÖ JWT w Authorization header (nie w cookies)
‚ö†Ô∏è Brak CSRF tokens (ale nie potrzebne z JWT)
```

#### Rate Limiting
```
Podatno≈õƒá:
Brak limitu pr√≥b logowania ‚Üí brute force

Mitigacja:
‚ùå Brak rate limiting w projekcie
‚úÖ TODO: Flask-Limiter (5 pr√≥b/minutƒô)
```

---

## 6. PYTANIA OBRONNE Z ODPOWIEDZIAMI

### Q1: "Jak dzia≈Ça autoryzacja w Twojej aplikacji od A do Z?"

**Odpowied≈∫:**
1. User wpisuje username i password
2. Frontend wysy≈Ça POST /api/Auth/login
3. Backend weryfikuje has≈Ço przez bcrypt.checkpw()
4. Backend generuje JWT z payload (user_id, role, exp)
5. Frontend zapisuje token w localStorage (web) lub SecureStore (mobile)
6. Przy ka≈ºdym reque≈õcie Axios interceptor dodaje `Authorization: Bearer <token>`
7. Backend middleware @require_auth dekoduje token i sprawdza wa≈ºno≈õƒá
8. Je≈õli valid ‚Üí request przechodzi, je≈õli nie ‚Üí 401 Unauthorized

---

### Q2: "Dlaczego JWT zamiast sesji?"

**Odpowied≈∫:**
JWT jest stateless - serwer nie musi przechowywaƒá sesji. To wa≈ºne przy skalowaniu:
- Mogƒô mieƒá 5 serwer√≥w backend za load balancerem
- Ka≈ºdy serwer mo≈ºe zweryfikowaƒá token bez wsp√≥≈Çdzielonego state
- Nie potrzebujƒô Redis do session storage
- Token zawiera wszystkie dane (user_id, role) wiƒôc nie muszƒô query bazy przy ka≈ºdym reque≈õcie

Wady JWT:
- Nie mogƒô "odwo≈Çaƒá" tokena (rozwiƒÖzanie: kr√≥tki exp lub blacklist)
- Token mo≈ºe byƒá wiƒôkszy ni≈º session ID

---

### Q3: "Jak zabezpieczasz API przed nieautoryzowanym dostƒôpem?"

**Odpowied≈∫:**
U≈ºywam dekoratora @require_auth na ka≈ºdym chroniony endpointcie:
1. Sprawdza czy request ma nag≈Ç√≥wek Authorization
2. Dekoduje JWT u≈ºywajƒÖc PyJWT
3. Sprawdza czy token nie wygas≈Ç (exp field)
4. Sprawdza podpis (signature verification z SECRET_KEY)
5. Je≈õli wszystko OK ‚Üí zapisuje user_id w Flask.g i wykonuje funkcjƒô
6. Je≈õli b≈ÇƒÖd ‚Üí zwraca 401 Unauthorized

Dodatkowo:
- CORS ogranicza origins (tylko frontend mo≈ºe wysy≈Çaƒá requesty)
- HTTPS w produkcji (szyfrowanie transportu)
- bcrypt dla hase≈Ç (ochrona przy wycieku bazy)

---

### Q4: "Jak dzia≈ÇajƒÖ przypomnienia w aplikacji mobilnej?"

**Odpowied≈∫:**
U≈ºywam polling pattern:
1. Custom hook useReminders() pobiera przypomnienia z API co 2 minuty
2. useEffect z setInterval sprawdza co 1 minutƒô czy jest przypomnienie na ten czas
3. Por√≥wnuje rok, miesiƒÖc, dzie≈Ñ, godzinƒô, minutƒô z remind_at
4. Je≈õli match ‚Üí wywo≈Çuje Alert.alert() (native alert)
5. Dodaje ID do shownReminders (aby nie pokazaƒá ponownie)
6. shownReminders jest resetowany ka≈ºdego dnia (lastCheckedDate)

Dlaczego nie push notifications?
- Prostsze w implementacji
- Nie wymaga konfiguracji FCM/APNs
- Dzia≈Ça tylko gdy app otwarty (wystarczajƒÖce dla CRM)

---

### Q5: "Jak synchronizujesz dane miƒôdzy web a mobile?"

**Odpowied≈∫:**
Nie ma synchronizacji offline. Obie aplikacje u≈ºywajƒÖ tego samego backend API:
1. Web i mobile wysy≈ÇajƒÖ zapytania do tego samego Flask backendu
2. Backend zwraca JSON z bazy danych
3. Ka≈ºda zmiana jest od razu zapisana w bazie
4. Pull-to-refresh w mobile od≈õwie≈ºa dane

To prostsza architektura ni≈º offline-first:
- Nie muszƒô rozwiƒÖzywaƒá konflikt√≥w (conflict resolution)
- Nie muszƒô przechowywaƒá danych lokalnie (AsyncStorage)
- Zawsze mam aktualne dane (single source of truth)

Dla offline support m√≥g≈Çbym dodaƒá:
- AsyncStorage cache
- Sync queue (zapytania wykonane offline)
- Conflict resolution strategy

---

### Q6: "Dlaczego Vite zamiast Webpack?"

**Odpowied≈∫:**
Vite jest znacznie szybszy:
1. Dev server start: Webpack ~30s (bundluje wszystko), Vite ~1s (ES modules)
2. Hot Module Replacement: Webpack ~2s, Vite instant
3. Build: Webpack wolny, Vite u≈ºywa esbuild (bardzo szybki)

Jak dzia≈Ça Vite:
- Zamiast bundlowaƒá wszystko, serwuje pliki on-demand
- PrzeglƒÖdarki nowoczesne wspierajƒÖ ES modules
- import { Button } from './Button' ‚Üí przeglƒÖdarka pobiera tylko Button.js
- W produkcji bundluje przez Rollup (optymalizacja)

Prostszy config:
- Webpack: 100+ linii konfiguracji
- Vite: 10 linii (plugin react + tailwind + proxy)

---

### Q7: "Jak testowa≈Çe≈õ aplikacjƒô?"

**Odpowied≈∫:**
**Backend:**
- Manual testing przez Postman
- Testy dla ka≈ºdego endpointu (GET, POST, PUT, DELETE)
- Sprawdzanie responses (200, 400, 401, 404, 500)
- Testowanie edge cases (brak tokena, nieprawid≈Çowe dane)

**Frontend Web:**
- Manual testing w przeglƒÖdarce (Chrome DevTools)
- Testowanie ka≈ºdej strony i funkcji
- Responsive testing (mobile, tablet, desktop)
- Cross-browser testing (Chrome, Firefox, Safari)

**Mobile:**
- Testing na Android emulatorze
- Expo Go na fizycznym urzƒÖdzeniu
- Testowanie synchronizacji z backendem

**Automated testing (TODO):**
- Backend: pytest + Flask test client
- Frontend: Vitest + React Testing Library
- E2E: Playwright lub Cypress

---

### Q8: "Jakie sƒÖ najwiƒôksze wyzwania w projekcie?"

**Odpowied≈∫:**
1. **Integracja backend ‚Üî frontend**
   - CORS errors (rozwiƒÖzane przez Flask-CORS + Vite proxy)
   - Token management (rozwiƒÖzane przez interceptory)
   - JSON parsing (.NET $values format)

2. **Debugowanie b≈Çƒôd√≥w autoryzacji**
   - 401 errors trudne do zdiagnozowania
   - Doda≈Çem extensive logging
   - Chrome DevTools Network tab

3. **Synchronizacja danych web ‚Üî mobile**
   - Pull-to-refresh dla consistency
   - Real-time updates (polling co 30s)

4. **PDF generation**
   - Polskie czcionki (DejaVu Sans)
   - Layout PDF (ReportLab learning curve)
   - Mobile sharing (Blob ‚Üí Base64 ‚Üí FileSystem)

---

### Q9: "Co by≈õ zmieni≈Ç/poprawi≈Ç?"

**Odpowied≈∫:**
1. **Testy automatyczne** - pytest, Vitest, E2E
2. **React Query** - lepszy cache management, optimistic updates
3. **WebSockets** - zamiast pollingu dla powiadomie≈Ñ
4. **PostgreSQL** - zamiast SQLite (produkcja)
5. **Docker** - ≈Çatwiejszy deployment
6. **CI/CD** - GitHub Actions (auto tests + deploy)
7. **Walidacja** - schema validation (Pydantic backend, Zod frontend)
8. **Rate limiting** - Flask-Limiter (5 pr√≥b login/min)
9. **Refresh tokens** - d≈Çugotrwa≈Çe sesje
10. **Error monitoring** - Sentry dla produkcji

---

### Q10: "Czy aplikacja jest gotowa do produkcji?"

**Odpowied≈∫:**
**Tak, ale z zastrze≈ºeniami:**

‚úÖ **Gotowe:**
- Funkcjonalno≈õƒá (CRUD, autoryzacja, PDF, powiadomienia)
- Bezpiecze≈Ñstwo podstawowe (JWT, bcrypt, CORS)
- UI/UX (responsive, intuicyjny)

‚ö†Ô∏è **Wymaga poprawek:**
1. Zmiana SECRET_KEY (env variable)
2. HTTPS (SSL certificate)
3. PostgreSQL (zamiast SQLite)
4. Rate limiting
5. Backup bazy danych
6. Monitoring i logging (Sentry, CloudWatch)
7. CDN dla statycznych plik√≥w
8. Load balancer (dla >100 u≈ºytkownik√≥w)

‚ùå **Brakuje:**
- Automated tests
- CI/CD pipeline
- Documentation API (Swagger)
- Admin panel (zarzƒÖdzanie u≈ºytkownikami)

**Dla ma≈Çej firmy (10-50 u≈ºytkownik√≥w):** Gotowe po poprawkach ‚ö†Ô∏è
**Dla du≈ºej firmy (>100 u≈ºytkownik√≥w):** Wymaga skalowania i test√≥w ‚ùå

---

**Ten dokument zawiera kompletny opis przep≈Çywu danych przez system oraz gotowe odpowiedzi na pytania obronne. Ka≈ºdy przep≈Çyw jest wyja≈õniony krok po kroku z wizualizacjami ASCII.**
